# React + Capacitor Example

A **simple, focused** example demonstrating OTA (Over-The-Air) updates with the `native-update` plugin.

## ğŸ¯ Purpose

This example shows the basic workflow of checking for, downloading, and applying OTA updates in a Capacitor app. **No unnecessary complexity** - just the plugin working.

## ğŸš€ Quick Start

### Prerequisites

- Node.js 18+ and pnpm installed
- A running backend server (see `example-apps/node-express` or `example-apps/firebase-backend`)

### Installation

```bash
# From the root of the monorepo
pnpm install

# Navigate to this example
cd example-apps/react-capacitor

# Install dependencies (if not already installed from root)
pnpm install
```

### Development

```bash
# Start the dev server
pnpm start

# Open http://localhost:5173
```

### Build for Mobile

#### Prerequisites for Mobile Development

**Android:**
- Android Studio installed
- Android SDK (API 34 recommended)
- Java JDK 17+

**iOS:**
- macOS with Xcode installed
- CocoaPods installed (`gem install cocoapods`)

#### Building for Android

```bash
# 1. Build the web assets
pnpm build

# 2. Sync with Capacitor
npx cap sync android

# 3. Open in Android Studio (optional)
npx cap open android

# 4. Build debug APK from command line
cd android
./gradlew assembleDebug

# Or run on connected device/emulator
pnpm android
```

**Output:** `android/app/build/outputs/apk/debug/app-debug.apk`

#### Building for iOS

```bash
# 1. Build the web assets
pnpm build

# 2. Sync with Capacitor
npx cap sync ios

# 3. Open in Xcode
npx cap open ios

# 4. Run on simulator/device
pnpm ios
```

## ğŸ“± How to Test OTA Updates

### Step 1: Start Backend Server

Choose one of the backend examples and start it:

```bash
# Option 1: Node.js + Express
cd example-apps/node-express
pnpm start

# Option 2: Firebase Functions
cd example-apps/firebase-backend
pnpm serve
```

### Step 2: Configure Server URL

Update the server URL in `src/App.tsx` if your backend is running on a different port:

```typescript
await NativeUpdate.configure({
  serverUrl: 'http://localhost:3000/api',  // Update this
  autoCheck: false,
  channel: 'production',
});
```

### Step 3: Test the Update Flow

1. **Click "Check for Updates"** - Checks if a new version is available
2. **Click "Download Update"** - Downloads the new bundle
3. **Click "Apply Update & Reload"** - Applies the update and reloads the app

### Step 4: Deploy a New Version

To test that updates actually work:

1. **Change the demo text** in `src/App.tsx`:
   ```tsx
   <p>
     âœ¨ <strong>This is version 2.0!</strong> âœ¨
   </p>
   ```

2. **Build a new bundle:**
   ```bash
   pnpm build
   ```

3. **Upload to your backend** (see backend README for upload instructions)

4. **Check for updates in the app** - You should see the new text after applying the update!

## ğŸ“‚ Project Structure

```
react-capacitor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.tsx       # Single component with all logic
â”‚   â”œâ”€â”€ App.css       # Simple styles
â”‚   â”œâ”€â”€ main.tsx      # Entry point
â”‚   â””â”€â”€ index.css     # Global styles
â”œâ”€â”€ android/          # Android project (Capacitor)
â”‚   â”œâ”€â”€ app/
â”‚   â””â”€â”€ build.gradle
â”œâ”€â”€ public/           # Static assets
â”œâ”€â”€ dist/             # Build output (web assets)
â”œâ”€â”€ capacitor.config.ts
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

**Note:** The `android/` folder is generated by Capacitor. iOS folder can be added with `npx cap add ios`.

## ğŸ¨ Features Demonstrated

- âœ… **Plugin initialization**
- âœ… **Check for updates** manually
- âœ… **Download progress** tracking
- âœ… **Apply updates** and reload app
- âœ… **Error handling**
- âœ… **Status updates** for user feedback

## ğŸ”§ Configuration Options

The plugin is configured with minimal options for simplicity:

```typescript
{
  serverUrl: 'http://localhost:3000/api',  // Backend server URL
  autoCheck: false,                        // Manual check only
  channel: 'production',                   // Update channel
}
```

For all available options, see the main plugin documentation.

## ğŸ› Troubleshooting

### "Error: Failed to initialize"

- **Cause:** Backend server not running or unreachable
- **Solution:** Start your backend server and ensure the `serverUrl` is correct

### "No updates available"

- **Cause:** No new version uploaded to backend
- **Solution:** Build and upload a new bundle to your backend server

### App doesn't reload after applying update

- **Cause:** Update might have failed silently
- **Solution:** Check the browser console for errors

## ğŸ“š Next Steps

- Read the [full plugin documentation](../../docs/)
- Try the [Node.js backend example](../node-express/)
- Try the [Firebase backend example](../firebase-backend/)
- Learn about [bundle signing and security](../../docs/BUNDLE_SIGNING.md)

## ğŸ’¡ Tips

1. **Start simple:** Get basic updates working before adding security features
2. **Use HTTPS in production:** The demo uses HTTP for simplicity, but always use HTTPS in production
3. **Test thoroughly:** Test the complete update flow on actual devices, not just in browser
4. **Monitor backend:** Check your backend logs to see update requests

---

**Built with â¤ï¸ by Ahsan Mahmood** | [aoneahsan.com](https://aoneahsan.com)
